Aby vısledky vyh¾adávania na Webe boli vdy aktuálne, je potrebné pravidelne prelieza Web a indexova jeho obsah. Keïe pracujete pre tajnú slubu, podarilo sa vám naprogramova novı vírus, ktorı dokáe prelieza Web nie cez odkazy na webovıch stránkach, ale šíri sa priamo cez sieové smerovaèe a dokáe tak vyh¾adáva prepojenia v oboch smeroch. Jedinı problém predstavujú iba niektoré firewally, take sa nedokáete dosta všade len touto metódou a musíte ho nasadi na viaceré miesta v sieti. Navyše aby vírus ostal v utajení, nemôe sa šíri paralelne, take vdy sa môe prešíri naraz len cez jedno sieové prepojenie.

Vašou úlohou je zisti, na ko¾ko miest musíte vírus nasadi a ko¾ko èasu bude trva, kım vírus prejde celı Web.

Špecifikácia vstupu: Na vstupe je nieko¾ko testovacích prípadov, na ktorıch chcete vírus otestova pred jeho reálnym nasadením. Pre kadı prípad sú najprv zadané dve èísla N (2 <= N <= 100 000) a M (0 <= M <= 10 000), kde N je poèet sieovıch uzlov a M je celkovı poèet prepojení medzi nimi. Nasleduje M trojíc èísel A,B a W, kadá na samostatnom riadku, kde A a B (1 <= A, B <= N) sú indexy sieovıch uzlov, medzi ktorımi existuje prepojenie a vírusu trvá C milisekúnd, kım sa cez toto prepojenie prešíri. Môete predpoklada, e celkovı èas prešírenia vírusu sa zmestí do 32-bitovej celoèíselnej premennej.

Špecifikácia vıstupu: Pre kadı testovací prípad vypoèítajte, na ko¾ko miest musíme vírus nasadi a ko¾ko milisekúnd bude trva, kım sa vírus prešíri cez celı Web.

Vedeli ste, e ...
Pri implementácii Kruskalovho algoritmu sa najèastejšie pouíva algoritmus zjedno-nájdi (z angl. Union-Find), ktorı vyuíva dátovú štruktúru disjunktnıch mnoín.

Tento algoritmus mono jednoducho implementova tak, e amortizovaná èasová zloitos na kadú operáciu bude O(alfa(n)), kde alfa(n) je inverzná Ackermannova funkcia.

Ackermannova funkcia je tak extrémne rıchlo rastúca, e alfa(n) je menej ako 5 pre všetky reálne pouite¾né hodnoty n.

Prvı, komu sa podarilo dokáza horné ohranièenie èasovej zloitosti tohto algoritmu, bol americkı vedec Robert Tarjan v roku 1975. Dovtedy najlepšie ohranièenie bolo O(log* n) - iterovanı logaritmus n, èo je ïalšia pomaly rastúca funkcia, avšak nie tak pomaly ako inverzná Ackermannova funkcia, ktoré dokázali americkí vedci John Edward Hopcroft a Jeffrey David Ullman v roku 1973.